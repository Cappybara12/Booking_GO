{{template "base" .}}

{{define "content"}}
    
<div class="container mt-5 text-center">
    <img src="/static/images/marjors-suite.png" class="img-fluid" style="max-width: 50%;" alt="Major Site Image" style="max-width: 50%; height: auto;">
    <h2 class="mt-3">Welcome to the Major Suite Page</h2>
    <p class="mt-3">This is the major site page content. Here we provide detailed information about our major offerings and services. Explore more to know what makes our services unique and exceptional. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin vel lorem id magna scelerisque luctus.</p>
    <a href="#!" id="check-availability"><button  class="btn btn-success " >Make Reservation</button>

    </div>
    {{end}}
    
{{define "js"}}
<script>
    document.getElementById("check-availability").addEventListener("click", function () {
        let html = `
            <form id="check-availability-form" action="" method="post" novalidate class="needs-validation">
                <div class="form-row">
                    <div class="col">
                        <div class="form-row" id="reservation-dates-modal">
                            <div class="col">
                                <input required class="form-control" type="date" name="start" id="start" placeholder="Arrival">
                            </div>
                            <div class="col">
                                <input required class="form-control" type="date" name="end" id="end" placeholder="Departure">
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        `;
        attention.custom({ 
            msg: html,
            title: "Choose your dates",
            callback: function(result) {
                let form = document.getElementById("check-availability-form");
                let formData = new FormData(form);
                formData.append("csrf_token", "{{.CSRFToken}}");
                formData.append("room_id", "2");

                fetch('/search-availability-json', {
                    method: "post",
                    body: formData,
                })
                .then(response => response.json())
                .then(data => {
                    if (data.ok) {
                        attention.custom({
                            icon: 'success',
                            showConfirmButton: false,
                            msg: '<p>Room is available!</p>'
                                + '<p><a href="/book-room?id='
                                + data.room_id
                                + '&s='
                                + data.start_date                                
                                + '&s='
                                + data.end_date
                                + '"class="btn btn-primary">'
                                + 'Book Now!</a></p>'
                        });
                    } else {
                        attention.error({
                            msg: "No availability",
                        });
                    }
                })
                .catch(error => console.log('Error:', error));
            }
        });
    });

    // document.addEventListener("DOMContentLoaded", function() {
    //     const today = new Date().toISOString().split('T')[0];
    //     document.getElementById("start").setAttribute("min", today);
    //     document.getElementById("end").setAttribute("min", today);
    // });
</script>
{{end}}